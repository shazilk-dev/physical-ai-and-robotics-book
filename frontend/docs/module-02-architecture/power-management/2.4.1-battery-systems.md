---
sidebar_position: 1
title: 2.4.1 Battery Systems & BMS Design
---

# 2.4.1 Battery Systems - Powering Humanoid Robots

## Introduction

**Question:** Why does Boston Dynamics' Spot run for only 90 minutes?

**Answer:** **Battery energy density** is the limiting factor. Spot's 605 Wh battery weighs 10 kg (60 Wh/kg) - current technology can't do much better without compromising safety!

In this section, you'll learn:
- Battery chemistry comparison (LiPo, NMC, LiFePO4)
- How to size batteries for robot runtime
- Battery Management System (BMS) design
- Safety considerations (thermal runaway, fire prevention)

---

## Battery Chemistry Comparison

### Key Metrics

| Chemistry | Energy Density | Power Density | Cycle Life | Cost | Safety |
|-----------|----------------|---------------|------------|------|--------|
| **LiPo (Li-Polymer)** | 150-200 Wh/kg | High (100C) | 300-500 | $$ | âš ï¸ Moderate |
| **NMC (Li-ion)** | 200-260 Wh/kg | Medium (30C) | 1000-2000 | $$$ | âœ… Good |
| **LiFePO4 (LFP)** | 90-120 Wh/kg | Low (10C) | 2000-5000 | $$ | âœ… Excellent |
| **Lead-Acid** | 30-50 Wh/kg | Very Low | 200-300 | $ | âœ… Good |

**For Humanoid Robots:** **NMC (Li-ion)** is the industry standard (Tesla Optimus, Unitree G1, Figure 02).

**Why NMC?**
- âœ… Best energy density (longer runtime)
- âœ… Long cycle life (>1000 charges)
- âœ… Acceptable safety (with proper BMS)
- âŒ More expensive than LiPo (but worth it for production robots)

---

### LiPo vs NMC Trade-offs

**LiPo (Budget Choice):**
```
Pros:
- High discharge rate (100C = 100Ã— capacity in amps)
- Cheap ($30-80 for 5000mAh 6S)
- Readily available (drone/RC market)

Cons:
- Short lifespan (300-500 cycles â†’ 1 year)
- Puffy/swollen when degraded (fire risk!)
- Lower energy density than NMC

Best for: Prototypes, research robots, budget builds
```

**NMC (Production Choice):**
```
Pros:
- High energy density (260 Wh/kg in 2024)
- Long lifespan (2000 cycles â†’ 5+ years)
- Stable chemistry (less prone to thermal runaway)

Cons:
- Expensive ($200-500 for equivalent capacity)
- Requires custom BMS (off-the-shelf options limited)
- Longer charge time (1-2 hours vs 30 min for LiPo)

Best for: Production humanoids, long-term deployments
```

---

## Battery Sizing for Humanoids

### Step 1: Calculate Power Budget

**Example: Mid-Size Humanoid**

```
Component Power Consumption (Watts):
- Motors (12Ã— joints @ 50W avg): 600W
- Jetson Orin (perception): 30W
- RealSense cameras (4Ã—): 20W
- Cooling fans: 10W
- Microcontroller (STM32): 5W

Total Average Power: 665W
Peak Power (jumping, running): 1500W (2.25Ã— average)
```

---

### Step 2: Determine Runtime Target

```
Target Runtime: 2 hours (typical for humanoid demos)

Energy Required:
E = Power Ã— Time
E = 665W Ã— 2 hours = 1330 Wh

With 20% safety margin (degradation, cold weather):
E_required = 1330 Wh Ã— 1.2 = 1596 Wh
```

---

### Step 3: Select Battery Configuration

**Option A: LiPo (Budget)**
```
Cell Spec: 5000mAh, 3.7V nominal, 4.2V max
Energy per cell: 5 Ah Ã— 3.7V = 18.5 Wh

Cells needed: 1596 Wh / 18.5 Wh = 86 cells

Configuration: 6S14P (6 series Ã— 14 parallel)
- Voltage: 6 Ã— 3.7V = 22.2V nominal, 25.2V max
- Capacity: 14 Ã— 5Ah = 70 Ah
- Energy: 22.2V Ã— 70 Ah = 1554 Wh âœ…
- Mass: 86 cells Ã— 90g/cell = 7.7 kg
- Cost: 86 cells Ã— $2.50/cell = $215

Problem: 86 cells require complex BMS! âŒ
```

---

**Option B: NMC Pouch Cells (Professional)**
```
Cell Spec: 50 Ah, 3.6V nominal, 4.2V max (LG M50T)
Energy per cell: 50 Ah Ã— 3.6V = 180 Wh
Mass per cell: 850g

Cells needed: 1596 Wh / 180 Wh = 9 cells (round up to 10 for margin)

Configuration: 10S1P (10 series)
- Voltage: 10 Ã— 3.6V = 36V nominal, 42V max
- Capacity: 50 Ah
- Energy: 36V Ã— 50 Ah = 1800 Wh âœ…
- Mass: 10 cells Ã— 850g = 8.5 kg
- Cost: 10 cells Ã— $40/cell = $400

Simpler BMS (only 10 cells to manage) âœ…
Higher voltage (more efficient for motor drivers) âœ…
```

**Winner:** Option B (NMC 10S1P) for production robot.

---

### Step 4: Verify C-Rating

**C-Rating:** Maximum safe discharge rate relative to capacity.

```
Peak current draw:
I_peak = Peak Power / Voltage
I_peak = 1500W / 36V = 41.7 A

Required C-rating:
C_required = I_peak / Capacity
C_required = 41.7 A / 50 Ah = 0.83C

NMC cells typically support 1C-3C continuous discharge âœ…
Peak bursts up to 5C for <10 seconds âœ…

Conclusion: 0.83C is safe for NMC!
```

---

## Battery Management System (BMS)

### What a BMS Does

**Core Functions:**
1. **Cell Balancing** - Equalizes voltages across series cells
2. **Overcharge Protection** - Cuts off charging at 4.2V per cell
3. **Over-discharge Protection** - Cuts off load at 2.8V per cell
4. **Overcurrent Protection** - Limits current to safe C-rating
5. **Temperature Monitoring** - Shuts down if cells overheat (>60Â°C)
6. **State of Charge (SoC) Estimation** - Calculates remaining capacity

---

### Active vs Passive Balancing

**Passive Balancing (Cheap):**
```
How it works:
- Shunt resistor across each cell
- When cell voltage > average, resistor bleeds off excess energy
- Energy is wasted as heat!

Pros: Simple, cheap ($50 BMS)
Cons: Slow (hours to balance), inefficient (wastes energy)

Use case: Budget robots, slow charging overnight
```

**Active Balancing (Professional):**
```
How it works:
- DC-DC converter transfers energy from high cells to low cells
- No energy wasted!

Pros: Fast (minutes to balance), efficient
Cons: Expensive ($200-500 BMS), complex circuitry

Use case: Production humanoids, fast turnaround time
```

**Humanoid Recommendation:** Active balancing BMS for 10S or higher configurations.

---

### BMS Selection Criteria

**Key Specs:**

| Parameter | Requirement (10S 50Ah NMC) |
|-----------|----------------------------|
| **Voltage Range** | 28V - 42V (10S Li-ion) |
| **Continuous Current** | 50A (1C discharge) |
| **Peak Current** | 100A (2C burst) |
| **Balancing Type** | Active (preferred) |
| **Balancing Current** | > 500 mA per cell |
| **Communication** | CAN bus (for ROS 2 integration) |
| **Temperature Sensors** | 4-6 thermistors |
| **Cost** | $200-400 for quality BMS |

**Recommended BMS:**
- **Orion BMS Jr.** ($450, active balancing, CAN bus)
- **BATRIUM WatchMon** ($350, modular design, Bluetooth)
- **Daly Smart BMS** ($180, basic but reliable)

---

### BMS Wiring Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Battery Pack (10S1P)          â”‚
â”‚                                         â”‚
â”‚  Cell 1 â”€â”¬â”€ Cell 2 â”€â”¬â”€ ... â”€â”¬â”€ Cell 10 â”‚
â”‚          â”‚          â”‚        â”‚          â”‚
â”‚  [+]     â”‚          â”‚        â”‚      [-] â”‚
â””â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚       â”‚          â”‚        â”‚
   â”‚   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   â”‚        BMS (10S, 50A)          â”‚
   â”‚   â”‚                                â”‚
   â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚   â”‚  â”‚  Cell Voltage Sensors    â”‚  â”‚
   â”‚   â”‚  â”‚  (11 wires: B0-B10)      â”‚  â”‚
   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚   â”‚                                â”‚
   â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚   â”‚  â”‚  Temperature Sensors     â”‚  â”‚
   â”‚   â”‚  â”‚  (4Ã— NTC thermistors)    â”‚  â”‚
   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚   â”‚                                â”‚
   â”‚   â”‚  [Charge Port] [Load Output]  â”‚
   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚             â”‚           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
   Main Switch (Emergency)    â”‚
                              â”‚
                        â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                        â”‚  Power      â”‚
                        â”‚Distribution â”‚
                        â”‚  Board      â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Charging System

### Charge Profile for Li-ion/NMC

**CC-CV (Constant Current - Constant Voltage):**

```
Phase 1: Constant Current (CC)
- Charge at 0.5C (25A for 50Ah pack)
- Voltage rises from 28V â†’ 42V
- Duration: ~1.5 hours (0-80% SoC)

Phase 2: Constant Voltage (CV)
- Hold voltage at 42V
- Current tapers from 25A â†’ 0A
- Duration: ~0.5 hours (80-100% SoC)

Total charge time: ~2 hours
```

---

### Charger Selection

**Key Requirements:**

| Spec | Value | Notes |
|------|-------|-------|
| **Output Voltage** | 42V | 10S Ã— 4.2V/cell |
| **Max Current** | 25A (0.5C) | Faster charging (1C) reduces lifespan |
| **Power** | 1050W | 42V Ã— 25A |
| **Connector** | XT90 or Anderson Powerpole | High-current rated |
| **Communication** | CAN bus (optional) | For BMS integration |

**Recommended Chargers:**
- **MeanWell HLG-1000H-42** ($180, 1000W, industrial-grade)
- **iCharger X12** ($350, smart charging, CAN interface)
- **DIY Li-ion Charger** ($80, Arduino + buck converter)

---

### Smart Charging with ROS 2

**Integration Example:**

```python
import rclpy
from rclpy.node import Node
from sensor_msgs.msg import BatteryState
import can  # python-can library

class BMSMonitor(Node):
    """Monitor BMS via CAN bus and publish battery status"""

    def __init__(self):
        super().__init__('bms_monitor')

        # CAN bus setup
        self.can_bus = can.interface.Bus(channel='can0', bustype='socketcan')

        # ROS 2 publisher
        self.pub_battery = self.create_publisher(BatteryState, 'battery_state', 10)

        # Timer for periodic CAN reads (10 Hz)
        self.timer = self.create_timer(0.1, self.read_bms)

    def read_bms(self):
        """Read BMS data from CAN bus"""
        # Request BMS status (specific to your BMS, see datasheet)
        msg_request = can.Message(arbitration_id=0x100, data=[0x01], is_extended_id=False)
        self.can_bus.send(msg_request)

        # Receive response
        msg_response = self.can_bus.recv(timeout=0.05)

        if msg_response:
            # Parse BMS data (example format)
            voltage = int.from_bytes(msg_response.data[0:2], 'big') / 100.0  # V
            current = int.from_bytes(msg_response.data[2:4], 'big', signed=True) / 10.0  # A
            soc = msg_response.data[4]  # %
            temperature = msg_response.data[5] - 40  # Â°C (offset by 40)

            # Publish ROS 2 message
            battery_msg = BatteryState()
            battery_msg.voltage = voltage
            battery_msg.current = current
            battery_msg.percentage = soc / 100.0
            battery_msg.temperature = float(temperature)

            if voltage < 30.0:
                battery_msg.power_supply_status = BatteryState.POWER_SUPPLY_STATUS_DISCHARGING
            elif current > 0.5:
                battery_msg.power_supply_status = BatteryState.POWER_SUPPLY_STATUS_CHARGING
            else:
                battery_msg.power_supply_status = BatteryState.POWER_SUPPLY_STATUS_FULL

            self.pub_battery.publish(battery_msg)

            self.get_logger().info(f'Battery: {voltage:.1f}V, {current:.1f}A, {soc}%, {temperature}Â°C')

def main(args=None):
    rclpy.init(args=args)
    node = BMSMonitor()
    rclpy.spin(node)
    node.destroy_node()
    rclpy.shutdown()
```

**Benefits:**
- Real-time battery monitoring in ROS 2 ecosystem
- Automatic low-battery warnings
- Integration with robot state machine (e.g., auto-return to dock when < 20%)

---

## Battery Safety

### Thermal Runaway Prevention

**What is Thermal Runaway?**

```
Overcharge â†’ Cell overheats â†’ Internal short â†’ More heat â†’ Explosion! ğŸ’¥
```

**Prevention Strategies:**

1. **BMS with Temperature Monitoring**
   - Shut down charging if cell temp > 45Â°C
   - Shut down discharging if cell temp > 60Â°C

2. **Fireproof Battery Enclosure**
   - Aluminum or steel case (not plastic!)
   - Vented design (gas release if cell ruptures)
   - Fire-resistant insulation between cells

3. **Current Limiting**
   - BMS enforces max charge/discharge current
   - Fuse or circuit breaker on main power line

4. **Voltage Monitoring**
   - BMS disconnects at 4.25V/cell (overcharge protection)
   - BMS disconnects at 2.7V/cell (over-discharge protection)

---

### Real-World Incident: LiPo Fire

**Case Study: Drone Battery Fire**

**What Happened:**
```
1. LiPo battery charged overnight with cheap charger (no BMS)
2. Charger failed to stop at 4.2V/cell â†’ overcharged to 4.4V
3. Cell vented, ignited other cells
4. Fire destroyed drone + workbench
```

**Lessons Learned:**
- âœ… Always use BMS with overcharge protection
- âœ… Never charge batteries unattended
- âœ… Store batteries in fireproof bag (LiPo safety bag, $15)
- âœ… Keep fire extinguisher nearby (Class D for lithium fires)

**Humanoid Robot Implication:** A battery fire in a humanoid could be catastrophic (robot destroyed + fire hazard). Invest in quality BMS!

---

## Battery Placement & Mechanical Design

### Low Center of Mass

**Goal:** Place battery as low as possible in robot for stability.

**Unitree G1 Example:**
```
Battery pack location: Pelvis (lowest point in torso)
Weight: 3.5 kg (11% of total robot mass)
CoM impact: Lowers robot CoM by 8 cm âœ…
```

**Design Tip:** Battery should be in the pelvis or lower torso, NOT in the chest or head!

---

### Hot-Swappable Battery Design

**Why Hot-Swap?**
- Zero downtime (swap battery in 10 seconds, keep working)
- Parallel battery packs (one charges while other is in use)

**Implementation:**
```
Robot has two battery bays:
- Bay A: Primary battery (powers robot)
- Bay B: Backup battery (on standby)

Swap Procedure:
1. Insert backup battery into Bay B
2. BMS automatically switches to parallel mode (both supply power)
3. Remove depleted battery from Bay A
4. Insert fresh battery into Bay A
5. BMS switches back to Bay A primary

No power interruption! âœ…
```

**Connector:** Anderson Powerpole or XT90 (rated for 50A+, secure locking).

---

## Battery Degradation & Lifecycle

### Capacity Fade Over Time

**Typical NMC Degradation:**
```
Cycle 0:    100% capacity (50 Ah)
Cycle 500:  90% capacity (45 Ah) â† 10% loss
Cycle 1000: 80% capacity (40 Ah) â† 20% loss (end of life)
Cycle 2000: 70% capacity (35 Ah)
```

**Factors Accelerating Degradation:**
- âŒ High charge/discharge rates (>1C)
- âŒ High temperature (>45Â°C during operation)
- âŒ Full charge storage (keeping battery at 100% for weeks)
- âŒ Deep discharge (running battery to 0%)

---

### Best Practices for Longevity

**1. Charge to 80%, Discharge to 20%**
```
Instead of using 0-100% range, use 20-80% range
Benefit: 2Ã— longer lifespan (1000 â†’ 2000 cycles)
Cost: 40% less usable energy

For 1800 Wh pack:
Usable energy = 1800 Ã— 0.6 = 1080 Wh (still acceptable for 1.5 hour runtime)
```

**2. Store at 50% SoC**
```
If robot won't be used for > 1 week:
- Charge or discharge to 50% (3.7V/cell)
- Store in cool, dry place (15-25Â°C)
- Check voltage monthly, recharge if < 45%
```

**3. Avoid High Temperatures**
```
Operating temp: -10Â°C to 45Â°C
Storage temp: 15Â°C to 25Â°C (optimal)

If operating in hot environment (>35Â°C):
- Add active cooling (fans on battery pack)
- Reduce charge/discharge rates
- Monitor BMS temperature closely
```

---

## Summary

### Key Takeaways

1. âœ… **NMC chemistry** is best for production humanoids (high energy density, long lifespan)
2. âœ… **BMS is mandatory** for safety (overcharge, over-discharge, thermal protection)
3. âœ… **Battery sizing:** Power budget Ã— Runtime Ã— 1.2 safety margin
4. âœ… **Active balancing** BMS is preferred for 10S+ configurations
5. âœ… **Low battery placement** improves robot stability (pelvis, not chest!)

---

### Battery Design Checklist

- [ ] Calculate power budget (average + peak)
- [ ] Determine runtime target (2 hours typical)
- [ ] Select chemistry (NMC for production, LiPo for prototypes)
- [ ] Size battery pack (10S1P configuration common)
- [ ] Choose BMS with active balancing, CAN bus, temp sensors
- [ ] Design fireproof enclosure with venting
- [ ] Place battery low in robot (pelvis)
- [ ] Integrate BMS monitoring with ROS 2
- [ ] Test thermal performance under load

---

## Practice Problems

### Problem 1: Battery Sizing

**Given:**
- Robot power: 800W average, 1800W peak
- Runtime target: 1.5 hours
- Battery: NMC 18650 cells (3.6V, 3.5 Ah, 50g each)

**Calculate:**
1. Required energy (Wh)
2. Number of cells needed
3. Optimal configuration (XS YP)
4. Total battery mass

---

### Problem 2: C-Rating Check

**Scenario:**
- Battery: 12S 30 Ah LiPo
- Peak current draw: 120A

**Questions:**
1. What C-rating is required?
2. Is this safe for typical LiPo (rated 25C)?

---

## Further Reading

### Recommended Resources

**Books:**
- "Lithium-Ion Batteries: Basics and Applications" - Yoshino (Nobel laureate in Li-ion chemistry)
- "Battery Management Systems for Large Lithium-Ion Battery Packs" - Bergveld

**Online:**
- [Battery University](https://batteryuniversity.com/) - Comprehensive battery education
- [NREL Battery Lifetime Tool](https://www.nrel.gov/transportation/battery-lifetime.html)

---

## Next Section

Now that you understand battery systems, it's time to learn about **thermal management** - keeping your robot cool under load!

Continue to **[Section 2.4.2: Thermal Design](./2.4.2-thermal-design.md)** ğŸ”¥â„ï¸

---

**Section Status:** âœ… Complete
**Estimated Reading Time:** 45 minutes
**Hands-On Project:** 2-3 hours (BMS selection and battery pack assembly)
